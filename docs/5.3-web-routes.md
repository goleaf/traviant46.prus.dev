### 5.3 Web Routes

The in-game HTTP endpoints are defined in `routes/web.php`. This file groups together every browser-facing route that the Travian server exposes and keeps the URL schema in one place. Routes are organised by feature area (e.g. village management, alliance administration, messaging, market interactions) to make it easy to reason about which controller or closure is responsible for serving each page.

#### Route model binding
Whenever a route needs to resolve a game entity by its identifier, the framework relies on implicit route model binding. Common bindings include:

- `village` &rarr; `App\Models\Village` – used for actions such as viewing, renaming, upgrading, and sending troops.
- `alliance` &rarr; `App\Models\Alliance` – powering alliance dashboards, membership management, and invitations.
- `player` &rarr; `App\Models\Player` – for profile views, messaging, and reports.
- `mapPosition` &rarr; `App\Models\Map\Tile` – for map lookups and oasis interactions.

By defining these bindings in a dedicated service provider, controllers can type-hint the model instead of manually querying the database, keeping the route declarations concise and less error-prone.

#### Middleware stack
Most web routes share a core middleware pipeline:

- `auth` ensures only authenticated users can reach game routes.
- `game.running` blocks access while the world is paused or under maintenance.
- `ban.check` prevents suspended accounts from interacting with the game.
- `localization` applies the player’s language and locale preferences.
- `throttle:game` rate-limits sensitive actions such as market trades or troop movements.

Additional middleware can be chained for specialised sections (for example, `can:manage-alliance` for alliance leadership panels). Grouping these middleware layers keeps cross-cutting concerns—like security, maintenance, and performance—centralised and consistent across every endpoint.

Together, the route declarations, model bindings, and middleware compose the HTTP surface of the Travian world, ensuring each request reaches the correct gameplay logic with the necessary guards in place.
