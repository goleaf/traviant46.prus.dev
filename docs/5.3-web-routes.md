### 5.3 Web Routes

The browser entry point for the Travian clone lives in `main_script/include/mainInclude.php`. Incoming requests hit `index.php`, which simply pulls in that bootstrap file. From there the router inspects `$_SERVER['REQUEST_URI']` and normalises it to a page key (e.g. `dorf1.php`, `reports.php`, `/info`). The helper logic strips query strings, guards against mismatched URIs, and falls back to `index.php` whenever a directory root (`/`) is requested. Any mismatch between the calculated key and the request URI is treated as a 404 so that only known filenames are dispatched. 【F:main_script/include/mainInclude.php†L1-L34】

Once the page key is resolved the router handles a handful of special endpoints before touching the generic controller stack:

- `/register` and `anmelden.php` redirect through `Core\Helper\WebService` depending on the current server configuration. 【F:main_script/include/mainInclude.php†L36-L56】
- `myInfo` responds with live JSON containing the village population and upkeep, and can optionally trigger a maintenance routine when `fix=1` is provided. 【F:main_script/include/mainInclude.php†L58-L70】
- `/info` behaves like a lightweight API endpoint, answering CORS pre-flight requests and returning world metadata such as server name, speed, storage multiplier, and release timers. 【F:main_script/include/mainInclude.php†L72-L110】

Every other web page is resolved through the `$pages` associative array. Each entry maps the requested filename to a controller class name, allowing the dispatcher to be agnostic about the concrete implementation. Examples include `dorf1.php` → `Dorf1Ctrl` for the village resources view, `allianz.php` → `AllianceCtrl` for alliance management, and `reports.php` → `BerichteCtrl` for the report inbox. Special handlers are registered as well, such as `403.php` for permission failures and `404.php` for missing pages. 【F:main_script/include/mainInclude.php†L112-L148】

The actual dispatch occurs through `Core\Dispatcher`. When called it prefixes the mapped name with the `Controller\` namespace, checks that the PHP file exists, instantiates the controller, and renders the response. If a controller cannot be found or throws a permission exception, the dispatcher automatically retries with the 404 or permission-denied controllers so that users receive a graceful error page. 【F:main_script/include/mainInclude.php†L150-L160】【F:main_script/include/Core/Dispatcher.php†L1-L60】

Finally, a guard clause catches any page key that is not registered in `$pages` and deliberately routes it to the 404 controller. This keeps the HTTP surface area explicit—new screens must be added to the `$pages` table before they become reachable—while still reusing the same dispatcher pipeline for every request. 【F:main_script/include/mainInclude.php†L150-L160】
